# 骨骼数据的归一化

## 何为归一化处理（即为什么进行归一化）
&emsp;&emsp;由于不同的评价指标往往具有不同的量纲（例如：对于评价房价来说量纲指：面积、房价数、楼层等；对于预测某个人患病率来说量纲指：身高、体重等。）和量纲单位（例如：面积单位：平方米、平方厘米等；身高：米、厘米等），这样的情况会影响到数据分析的结果，为了消除指标之间量纲的影响，需要进行数据标准化处理，以解决数据指标之间的可比性。原始数据经过数据标准化处理后，各指标处于同一数量级，适合进行综合对比评价。

## 归一化有什么好处呢？

(1)提升模型的收敛速度

&emsp;&emsp;如下图，x1的取值为0-2000，而x2的取值为1-5，假如只有这两个特征，对其进行优化时，会得到一个窄长的椭圆形，导致在梯度下降时，梯度的方向为垂直等高线的方向而走之字形路线，这样会使迭代很慢，相比之下，右图的迭代就会很快（理解：也就是步长走多走少方向总是对的，不会走偏）。

(2)提升模型的精度

归一化的另一好处是提高精度，这在涉及到一些距离计算的算法时效果显著，比如算法要计算欧氏距离，上图中x2的取值范围比较小，涉及到距离计算时其对结果的影响远比x1带来的小，所以这就会造成精度的损失。所以归一化很有必要，他可以让各个特征对结果做出的贡献相同。

(3)深度学习中数据归一化可以防止模型梯度爆炸。

【 注：以下为标准化的介绍（可以选择略过）】

数据的标准化（normalization）是将数据按比例缩放，使之落入一个小的特定区间。在多指标评价体系中，由于各评价指标的性质不同，通常具有不同的量纲和数量级。当各指标间的水平相差很大时，如果直接用原始指标值进行分析，就会突出数值较高的指标在综合分析中的作用，相对削弱数值水平较低指标的作用。因此，为了保证结果的可靠性，需要对原始指标数据进行标准化处理。

在数据分析之前，我们通常需要先将数据标准化（normalization），利用标准化后的数据进行数据分析。数据标准化也就是统计数据的指数化。数据标准化处理主要包括数据同趋化处理和无量纲化处理两个方面。数据同趋化处理主要解决不同性质数据问题，对不同性质指标直接加总不能正确反映不同作用力的综合结果，须先考虑改变逆指标数据性质，使所有指标对测评方案的作用力同趋化，再加总才能得出正确结果。数据无量纲化处理主要解决数据的可比性。经过上述标准化处理，原始数据均转换为无量纲化指标测评值，即各指标值都处于同一个数量级别上，可以进行综合测评分析。

目前数据标准化方法有多种，归结起来可以分为直线型方法(如极值法、标准差法)、折线型方法(如三折线法)、曲线型方法(如半正态性分布)。不同的标准化方法，对系统的评价结果会产生不同的影响，然而不幸的是，在数据标准化方法的选择上，还没有通用的法则可以遵循。

其中最典型的就是数据的归一化处理，即将数据统一映射到[0,1]区间上。从经验上说，归一化是让不同维度之间的特征在数值上有一定比较性，可以大大提高分类器的准确性。

【 警报解除，继续修炼。】


## 怎么对骨骼数据进行归一化处理呢？

对于骨骼数据，我们得到的每一帧的数据是20个关节点的位置坐标（u，v，d）的数据。接下来我们按照最近看到的一篇关于骨骼数据处理的论文提出的方法，将其归结为以下步骤进行骨骼数据归一化处理。

（1）首先对某一帧的数据来说，将所有节点的3维数据减去中心节点位置的3维数据，得到与中心节点的相对位置。

【注：完成将坐标数据的数值按照比例进行缩小。】
![图1](https://pic3.zhimg.com/80/v2-a568e555b50489b45114a81e1728c5a6_720w.jpg)

（2）计算每帧中每个相邻节点的骨骼距离。

其中使用二范数进行每个相邻节点之间的距离计算。
![图2](https://pic3.zhimg.com/80/v2-6eddc1ea60794a09d99254b620942a2a_720w.jpg)

（3）求出同一个样本的所有帧的平均骨骼长度

【注：以下使用RR符号来标记每个样本的平均骨骼长度向量。】

（4）利用每个样本的平均骨骼长度求所有样本的平均骨骼长度

【注：以下使用R符号来标记所有样本的平均骨骼长度向量。】

接下来我们利用得到的R进行关节点数据的归一化处理工作。

（5）针对每个样本中每帧数据进行更新处理

依次对每个样本中的每一帧的关节点数据进行处理

5.1 对于各个样本得到RR，

若RR中某个骨骼长度为0，则使用关节点相邻表中的相邻数据重新计算该骨骼连接关节的3维坐标差，并标记为bone。

【注1：统一使用关节点相邻表中下行减去上行的节点计算3维坐标差。】

【注2：此时得到的bone是一个3*1或1*3的向量】

若RR中某个骨骼长度不为0，按照下面的公式计算出一个bone。

$$ bone=\frac{(bone0)*R[k]}{RR[k} $$

其中bone0表示连接关节的3维坐标差，RR[k]和R[k]中的k表示第k段骨骼，k的取值范围为1-19。

5.2 更新关节点的坐标数据，

根据关节点相邻表中的第一行关节点的数据和bone的数据相加对第二行关节点的数据进行坐标更新。





